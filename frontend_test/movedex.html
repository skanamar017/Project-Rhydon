<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple Move Dex</title>
</head>
<body>
    <h1>Move Dex</h1>
    <div>
        <input type="text" id="search" placeholder="Search by move name...">
        <button onclick="loadMovedex()">Search</button>
    </div>
    <div id="movedex"></div>
    <div id="move-details" style="margin-top:20px;"></div>
    <script>
    const BASE_URL = 'http://127.0.0.1:5001';
    async function loadMovedex() {
        const search = document.getElementById('search').value;
    let url = `${BASE_URL}/movedex`;
    if (search) url += `?search=${encodeURIComponent(search)}`;
        const res = await fetch(url);
        const data = await res.json();
        const movedexDiv = document.getElementById('movedex');
        movedexDiv.innerHTML = '<pre style="background:#eee;padding:5px;">API Response:\n' + JSON.stringify(data, null, 2) + '</pre>';
        (data.moves || data).forEach(m => {
            const d = document.createElement('div');
            d.textContent = `${m.name} (${m.type}) Power: ${m.power || '-'} PP: ${m.pp || '-'}`;
            d.style.cursor = 'pointer';
            d.onclick = async () => {
                const resp = await fetch(`${BASE_URL}/movedex/${m.id}`);
                const details = await resp.json();
                const detailsDiv = document.getElementById('move-details');
                let pokemonHtml = '<pre style="background:#eee;padding:5px;">API Response:\n' + JSON.stringify(details, null, 2) + '</pre>';
                if (details.pokemon && details.pokemon.length > 0) {
                    pokemonHtml += `<h4>Pokémon that can learn this move:</h4><ul>` +
                        details.pokemon.map(p => `<li>#${p.pokedex_number} ${p.name} (Lv. ${p.level_learned})</li>`).join('') +
                        `</ul>`;
                } else {
                    pokemonHtml += '<p>No Pokémon can learn this move.</p>';
                }
                detailsDiv.innerHTML = `
                    <h3>${details.name}</h3>
                    <p><b>Type:</b> ${details.type}</p>
                    <p><b>Power:</b> ${details.power || '-'}</p>
                    <p><b>Accuracy:</b> ${details.accuracy || '-'}</p>
                    <p><b>PP:</b> ${details.pp || '-'}</p>
                    <p><b>Description:</b> ${details.effect_description || details.description || 'No description available.'}</p>
                    ${pokemonHtml}
                `;
            };
            movedexDiv.appendChild(d);
        });
    }
    window.onload = loadMovedex;
    </script>
</body>
</html>
